{% extends "template.html" %}
{% load static %}

{% block titulo %}Produtos{% endblock titulo %}

{% block conteudo %}
    <section class="produtos-section">
        <h1 class="section-title">Nossos Produtos</h1>
        <div class="produtos-grid">
            {% for p in prods %}
                <div class="produto-card">

                    <div class="produto-imagem">
                        {# 1º tenta usar um LINK direto (campo imagem_url) #}
                        {% if p.imagem_url %}
                            <img src="{{ p.imagem_url }}" alt="{{ p.nome }}">

                        {# 2º, se não tiver link, usa a foto enviada no admin #}
                        {% elif p.foto %}
                            <img src="{{ p.foto.url }}" alt="{{ p.nome }}">

                        {# 3º, se não tiver nada, usa uma imagem padrão #}
                        {% else %}
                            <img src="{% static 'images/images.png' %}" alt="{{ p.nome }}">
                        {% endif %}
                    </div>

                    <div class="produto-info">
                        <h3>{{ p.nome }}</h3>
                        <p class="produto-descricao">{{ p.descricao|truncatewords:20 }}</p>

                        {% if p.categoria %}
                            <span class="produto-categoria">{{ p.categoria }}</span>
                        {% endif %}

                        <div class="produto-preco">
                            <span class="preco">R$ {{ p.preco|floatformat:2 }}</span>
                            <span class="estoque">Estoque: {{ p.estoque }}</span>
                        </div>

                        <a href="{% url 'comprar' p.id %}" class="btn-comprar">Comprar</a>
                    </div>
                </div>
            {% empty %}
                <p class="no-products">Nenhum produto disponível no momento.</p>
            {% endfor %}
        </div>
    </section>
{% endblock conteudo %}
